<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orientation √âtudiante - Choix de Domaine</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Choix de Domaine Technologique</h1>
        <p>Veuillez remplir le formulaire ci-dessous pour enregistrer vos informations et choisir votre domaine d'√©tude.</p>
    </header>

    <main>
        <form id="orientationForm" action="#" method="POST">
            <h2>1. Vos Informations Personnelles</h2>
            
            <label for="nom">Nom et Pr√©noms :</label>
            <input type="text" id="nom" name="Nom" required>

            <label for="age">√Çge :</label>
            <input type="number" id="age" name="Age" required min="16" max="60">

            <label for="classe">Classe :</label>
            <select id="classe" name="Classe" required>
                <option value="" disabled selected>S√©lectionnez votre classe</option>
                <option value="CP 1_A">CP 1_A</option>
                <option value="CP 1_B">CP 1_B</option>
            </select>

            <label for="bac">Bac Obtenu :</label>
            <input type="text" id="bac" name="Bac_Obtenu" placeholder="Ex: S, D, C, etc." required>
            
            <label for="moyenne">Moyenne Obtenue au Bac :</label>
            <input type="number" id="moyenne" name="Moyenne_Bac" step="0.01" min="10.00" max="20.00" required>
            
            <hr>

            <h2>2. Choisissez votre Domaine</h2>
            
            <div class="choix-container">
                <button type="button" data-domaine="robotique" class="btn-choix">ü§ñ Robotique</button>
                <button type="button" data-domaine="ia" class="btn-choix">üß† Intelligence Artificielle</button>
                <button type="button" data-domaine="devweb" class="btn-choix">üåê D√©veloppement Web</button>
            </div>
            
            <input type="hidden" id="domaineChoisi" name="Domaine_Choisi" value="">
            
            <button type="submit" id="submitBtn" disabled>Valider et Continuer</button>
            <p id="messageErreur" style="color: red; display: none;">Veuillez d'abord choisir un domaine.</p>
        </form>
    </main>

    <script>
        <script>
    const form = document.getElementById('orientationForm');
    const btnsChoix = document.querySelectorAll('.btn-choix');
    const domaineChoisiInput = document.getElementById('domaineChoisi');
    const submitBtn = document.getElementById('submitBtn');

    // Mettez ici l'URL que vous avez copi√©e de Google Apps Script
    // Exemple : const GOOGLE_SHEET_ENDPOINT = 'https://script.google.com/macros/s/AKfyc.../exec';
    const GOOGLE_SHEET_ENDPOINT = 'https://script.google.com/macros/s/AKfycbwDHFbzVwx4v5sD7trp2MHS5fbBHHkd2jlw1Kosyu4YxCMIoEmcufGbEzh81hhuyjV2-A/exec'; 
    
    // 1. Gestion du choix de domaine
    btnsChoix.forEach(button => {
        button.addEventListener('click', (event) => {
            btnsChoix.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            const choix = event.target.getAttribute('data-domaine');
            domaineChoisiInput.value = choix;
            submitBtn.disabled = false;
        });
    });

    // 2. Gestion de la soumission du formulaire
    form.addEventListener('submit', function(e) {
        e.preventDefault(); // Emp√™che l'envoi HTML standard

        if (!domaineChoisiInput.value) {
            alert("Veuillez choisir un domaine avant de valider.");
            return;
        }

        // R√©cup√©rer toutes les donn√©es du formulaire
        const formData = new FormData(form);
        
        // Convertir les donn√©es en format URL-encoded pour Apps Script
        const urlEncodedData = new URLSearchParams(formData).toString();
        
        // Bloquer le bouton pendant l'envoi pour √©viter les doublons
        submitBtn.disabled = true;
        submitBtn.textContent = "Envoi en cours...";

        // Envoi des donn√©es √† Google Sheets via Apps Script
        fetch(GOOGLE_SHEET_ENDPOINT, {
            method: 'POST',
            body: urlEncodedData,
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            }
        })
        .then(response => {
            // Le statut OK (200) de Apps Script est renvoy√© m√™me s'il ne contient que "OK"
            console.log('Donn√©es envoy√©es avec succ√®s √† Google Sheet.');
            
            // REDIRECTION apr√®s l'envoi r√©ussi
            const domaine = domaineChoisiInput.value;
            window.location.href = `info-${domaine}.html`;
        })
        .catch(error => {
            console.error('Erreur lors de l\'envoi des donn√©es :', error);
            alert("Une erreur est survenue lors de l'enregistrement. Veuillez r√©essayer.");
            submitBtn.disabled = false;
            submitBtn.textContent = "Valider et Continuer";
        });
    });
</script>
    </script>
</body>
</html>
